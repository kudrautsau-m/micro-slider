'use strict';var _Mathabs=Math.abs,_Mathround=Math.round,_createClass=function(){function a(b,d){for(var g,f=0;f<d.length;f++)g=d[f],g.enumerable=g.enumerable||!1,g.configurable=!0,'value'in g&&(g.writable=!0),Object.defineProperty(b,g.key,g)}return function(b,d,f){return d&&a(b.prototype,d),f&&a(b,f),b}}(),_typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a};function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}(function(a){'use strict';'function'==typeof define&&define.amd?define(a):'object'===('undefined'==typeof exports?'undefined':_typeof(exports))&&'object'===('undefined'==typeof module?'undefined':_typeof(module))?module.exports=a():'object'===('undefined'==typeof window?'undefined':_typeof(window))&&(window.MicroSlider=a())})(function(){'use strict';var a=function(){function b(d){var f=this,g=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,b),this.getXPos=function(h){var j=h.clientX;return h.targetTouches&&1<=h.targetTouches.length&&(j=h.targetTouches[0].clientX),j},this.getYPos=function(h){var j=h.clientY;return h.targetTouches&&1<=h.targetTouches.length&&(j=h.targetTouches[0].clientY),j},this.getClosestItem=function(h){if(h.classList.contains(f.options.sliderItemClass))return h;for(var j;h;){if(j=h.parentElement,j&&j.classList.contains(f.options.sliderItemClass))return j;h=j}return null},this.getItemIndex=function(h){for(var j=0;j<f.itemCount;j++)if(f.items[j]===h)return j;return-1},this.prevHandler=function(){var h=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;f.target=f.dim*_Mathround(f.offset/f.dim)-f.dim*h,f.offset!==f.target&&(f.amplitude=f.target-f.offset,f.timestamp=Date.now(),requestAnimationFrame(f.autoScroll))},this.nextHandler=function(){var h=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;f.target=f.dim*_Mathround(f.offset/f.dim)+f.dim*h,f.offset!==f.target&&(f.amplitude=f.target-f.offset,f.timestamp=Date.now(),requestAnimationFrame(f.autoScroll))},this.clickHandler=function(h){if(h.target.classList.contains(f.options.sliderItemClass)){if(f.draggedY)return h.preventDefault(),h.stopPropagation(),!1;if(!f.options.fullWidth){var j=f.getClosestItem(h.target),k=f.getItemIndex(j),l=f.center%f.itemCount-k;0!=l&&(h.preventDefault(),h.stopPropagation()),f.cycleTo(k)}}},this.tapHandler=function(h){(h.target===f.sliderContainer||h.target.classList.contains(f.options.sliderItemClass))&&h.preventDefault(),f.pressed=!0,f.draggedX=!1,f.draggedY=!1,f.velocity=0,f.amplitude=0,f.frame=f.offset,f.timestamp=Date.now(),f.referencePos={x:f.getXPos(h),y:f.getYPos(h)},clearInterval(f.ticker),f.ticker=setInterval(f.track,100)},this.dragHandler=function(h){if(f.pressed){var j=f.getXPos(h),k=f.getYPos(h),l=f.referencePos.x-j,m=_Mathabs(f.referencePos.y-k);if(30>m&&!f.draggedX)(2<l||-2>l)&&(f.draggedY=!0,f.referencePos.x=j,f.scroll(f.offset+l));else{if(f.draggedY)return h.preventDefault(),h.stopPropagation(),!1;f.draggedX=!0}}return f.draggedY?(h.preventDefault(),h.stopPropagation(),!1):void 0},this.releaseHandler=function(h){if(f.pressed)return f.pressed=!1,clearInterval(f.ticker),f.target=f.offset,(10<f.velocity||-10>f.velocity)&&(f.amplitude=0.9*f.velocity,f.target=f.offset+f.amplitude),f.target=_Mathround(f.target/f.dim)*f.dim,f.options.noWrap&&(f.target>=f.dim*(f.itemCount-1)?f.target=f.dim*(f.itemCount-1):0>f.target&&(f.target=0)),f.amplitude=f.target-f.offset,f.timestamp=Date.now(),requestAnimationFrame(f.autoScroll),f.draggedY&&(h.preventDefault(),h.stopPropagation()),!1},this.resizeHandler=function(){f.options.fullWidth?(f.setSliderDimensions(),f.offset=2*f.center*f.itemDimensions.width,f.target=f.offset):f.scroll()},this.track=function(){var h=Date.now(),j=h-f.timestamp;f.timestamp=h;var k=f.offset-f.frame;f.frame=f.offset;f.velocity=0.8*(1e3*k/(1+j))+0.2*f.velocity},this.wrap=function(h){var j=f.itemCount;return h>=j?h%j:0>h?f.wrap(j+h%j):h},this.cycleTo=function(h){var j=f.itemCount,k=f.center%j-h;f.options.noWrap||(0>k&&_Mathabs(k+j)<_Mathabs(k)?k+=j:0<k&&_Mathabs(k-j)<k&&(k-=j)),0>k?f.nextHandler(_Mathabs(k)):0<k&&f.prevHandler(k)},this.scroll=function(){var h=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,j=void 0,k=0,l=void 0,m=void 0;f.setScrollTimeout(),f.lastCenter=f.center,f.offset='number'==typeof h?h:f.offset,f.center=Math.floor((f.offset+f.dim/2)/f.dim);var o=f.offset-f.center*f.dim,p=0>o?1:-1,q=2*(-p*o)/f.dim,r=f.itemCount>>1;for((!f.options.noWrap||0<=f.center&&f.center<f.itemCount)&&(j=f.items[f.wrap(f.center)],f.setActiveItem(j),f.renderTranslation(j,0,f.options.fullWidth?1:1-0.2*q,-o/2,f.options.zoomScale*q,p*f.options.shift*q*k)),k=1;k<=r;++k)f.options.fullWidth?(m=f.options.zoomScale,l=k==r&&0>o?1-q:1):(m=f.options.zoomScale*(2*k+q*p),l=1-0.2*(2*k+q*p)),(!f.options.noWrap||f.center+k<f.itemCount)&&(j=f.items[f.wrap(f.center+k)],f.renderTranslation(j,-k,l,f.options.shift+(f.dim*k-o)/2,m)),f.options.fullWidth?(m=f.options.zoomScale,l=k==r&&0<o?1-q:1):(m=f.options.zoomScale*(2*k-q*p),l=1-0.2*(2*k-q*p)),(!f.options.noWrap||0<=f.center-k)&&(j=f.items[f.wrap(f.center-k)],f.renderTranslation(j,-k,l,-f.options.shift+(-f.dim*k-o)/2,m));f.lastCenter!==f.center&&'function'==typeof f.options.onCycleTo&&f.options.onCycleTo.call(f,f.activeItem,f.draggedY)},this.setScrollTimeout=function(){f.scrolling=!0,f.sliderContainer.classList.contains(f.options.scrollingClass)&&f.sliderContainer.classList.add(f.options.scrollingClass),null!=f.scrollingTimeout&&window.clearTimeout(f.scrollingTimeout),f.scrollingTimeout=window.setTimeout(function(){f.scrolling=!1,f.sliderContainer.classList.remove(f.options.scrollingClass)},f.options.transitionDuration)},this.setActiveItem=function(h){h.classList.contains(f.options.activeItemClass)||(null!==f.activeItem&&f.activeItem.classList.remove(f.options.activeItemClass),f.activeItem=h,f.activeItemIndex=f.getItemIndex(h),!f.activeItem.classList.contains(f.options.activeItemClass)&&f.activeItem.classList.add(f.options.activeItemClass)),f.setActiveIndicator()},this.setActiveIndicator=function(){f.options.indicators&&f.activeIndicator!==f.indicators[f.activeItemIndex]&&(f.activeIndicator.classList.remove(f.options.indicatorActiveClass),f.activeIndicator=f.indicators[f.activeItemIndex],f.activeIndicator.classList.add(f.options.indicatorActiveClass))},this.renderTranslation=function(h,j,k,l,m){var o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,p='translateX(0)';if(!f.options.fullWidth){var r=(f.sliderContainer.clientWidth-f.itemDimensions.width)/2,s=(f.sliderContainer.clientHeight-f.itemDimensions.height)/2;p='translateX('+r+'px) translateY('+s+'px)'}var q='';null!==o&&(q='translateX('+o+'px) '),h.style[f.xForm]=p+' translateX('+l+'px) '+q+'translateZ('+m+'px)',h.style.zIndex=j,h.style.opacity=k,h.style.display='block'},this.autoScroll=function(){if(f.amplitude){var h=Date.now()-f.timestamp,j=f.amplitude*Math.exp(-h/f.options.transitionDuration);2<j||-2>j?(f.scroll(f.target-j),requestAnimationFrame(f.autoScroll)):f.scroll(f.target)}},this.next=function(){var h=f.activeItemIndex+1;(!f.options.noWrap||f.options.noWrap&&h<f.itemCount)&&f.cycleTo(h)},this.prev=function(){var h=f.activeItemIndex-1;(!f.options.noWrap||f.options.noWrap&&0<=h)&&f.cycleTo(h)},this.set=function(h){return f.cycleTo(h)},this.activeIndicator=null,this.activeItem=null,this.activeItemIndex=0,this.amplitude=null,this.center=0,this.sliderContainer=d,this.draggedX=!1,this.draggedY=!1,this.frame=null,this.lastCenter=null,this.offset=0,this.options=Object.assign({},b.defaults,g),this.pressed=!1,this.referencePos={x:0,y:0},this.scrolling=!1,this.scrollingTimeout=null,this.target=0,this.ticker=null,this.timestamp=null,this.velocity=null,this.init()}return _createClass(b,[{key:'init',value:function init(){this.setSliderContainer(),this.setSliderItems(),this.setSliderDimensions(),this.setIndicators(),this.setXForm(),this.bindEvents(),this.sliderContainer.classList.contains(this.options.initializedClass)?(this.resizeHandler(),this.cycleTo(this.activeItemIndex)):this.sliderContainer.classList.add(this.options.initializedClass),this.scroll()}},{key:'setSliderContainer',value:function setSliderContainer(){if('string'==typeof this.sliderContainer&&(this.sliderContainer=document.querySelector(this.sliderContainer)),!(this.sliderContainer instanceof HTMLElement))throw new Error('\n        The slider needs to be instantiated with an HTML Element as the first parameter or a valid CSS selector.\n        eg.: new Carousel(document.getElementById(\'MyElement\')) or new Carousel(\'#myElement\').\n      ');this.sliderContainer.classList.contains(this.options.sliderClass)||this.sliderContainer.classList.add(this.options.sliderClass)}},{key:'setSliderItems',value:function setSliderItems(){var d=this.sliderContainer.children;this.items=[];for(var h,f=0,g=d.length;f<g;f++)h=d[f],h.classList.contains(this.options.sliderItemClass)&&(this.items.push(h),h.classList.contains(this.options.activeItemClass)&&(this.activeItemIndex=f));if(this.itemCount=this.items.length,!this.itemCount)throw new Error('\n        The slider does not contain any valid items. \n        Please ensure that the items have the class name \'slider-item\' appended to them.\n      ')}},{key:'setSliderDimensions',value:function setSliderDimensions(){var d=this.items[0];d.style.display='block',this.itemDimensions={height:d.offsetHeight,width:d.offsetWidth},this.sliderContainer.style.height=d.offsetHeight,this.dim=2*this.itemDimensions.width+this.options.padding,d.style.display='none'}},{key:'setIndicators',value:function setIndicators(){var d=this;if(this.options.indicators){this.indicators=[],this.indicatorContainer=document.createElement(this.options.indicatorContainerTag),this.indicatorContainer.className=this.options.indicatorContainerClass,this.sliderContainer.appendChild(this.indicatorContainer);for(var f=function _loop(g){var h=document.createElement(d.options.indicatorItemTag);h.className=d.options.indicatorItemClass,h.innerHTML='<a href="#">'+d.options.indicatorText+'</a>',0===g&&(d.activeIndicator=h,h.classList.add(d.options.indicatorActiveClass)),h.addEventListener('click',function(j){j.preventDefault(),d.set(g)}),d.indicatorContainer.appendChild(h),d.indicators.push(h)},g=0;g<this.itemCount;g++)f(g)}}},{key:'setXForm',value:function setXForm(){var d='transform';['webkit','Moz','O','ms'].forEach(function(f){var g=f+'Transform';'undefined'!=typeof document.body.style[g]&&(d=g)}),this.xForm=d}},{key:'bindEvents',value:function bindEvents(){'undefined'!=typeof window.ontouchstart&&(this.sliderContainer.addEventListener('touchstart',this.tapHandler),this.sliderContainer.addEventListener('touchmove',this.dragHandler),this.sliderContainer.addEventListener('touchend',this.releaseHandler)),this.sliderContainer.addEventListener('mousedown',this.tapHandler),this.sliderContainer.addEventListener('mousemove',this.dragHandler),this.sliderContainer.addEventListener('mouseup',this.releaseHandler),this.sliderContainer.addEventListener('mouseleave',this.releaseHandler),this.sliderContainer.addEventListener('click',this.clickHandler),window.addEventListener('resize',this.resizeHandler)}}]),b}();return a.defaults={activeItemClass:'active',fullWidth:!1,scrollingClass:'scrolling',indicators:!1,indicatorActiveClass:'active',indicatorContainerTag:'ul',indicatorContainerClass:'indicators',indicatorItemTag:'li',indicatorItemClass:'indicator',indicatorText:'&bull;',initializedClass:'initialized',noWrap:!1,onCycleTo:null,padding:0,shift:0,sliderClass:'micro-slider',sliderItemClass:'slider-item',transitionDuration:250,zoomScale:-100},a});
