"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _Mathabs=Math.abs,_Mathround=Math.round,_createClass=function(){function t(t,e){for(var i,n=0;n<e.length;n++)i=e[n],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){"function"==typeof define&&define.amd?define(t):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=t():"object"===("undefined"==typeof window?"undefined":_typeof(window))&&(window.MicroSlider=t())}(function(){var t=function(){function t(e){var i=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),this.getXPos=function(t){var e=t.clientX;return t.targetTouches&&1<=t.targetTouches.length&&(e=t.targetTouches[0].clientX),e},this.getYPos=function(t){var e=t.clientY;return t.targetTouches&&1<=t.targetTouches.length&&(e=t.targetTouches[0].clientY),e},this.getClosestItem=function(t){if(t.classList.contains(i.options.sliderItemClass))return t;for(var e;t;){if((e=t.parentElement)&&e.classList.contains(i.options.sliderItemClass))return e;t=e}return null},this.getItemIndex=function(t){for(var e=0;e<i.itemCount;e++)if(i.items[e]===t)return e;return-1},this.prevHandler=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;i.target=i.dim*_Mathround(i.offset/i.dim)-i.dim*t,i.offset!==i.target&&(i.amplitude=i.target-i.offset,i.timestamp=Date.now(),requestAnimationFrame(i.autoScroll))},this.nextHandler=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;i.target=i.dim*_Mathround(i.offset/i.dim)+i.dim*t,i.offset!==i.target&&(i.amplitude=i.target-i.offset,i.timestamp=Date.now(),requestAnimationFrame(i.autoScroll))},this.clickHandler=function(t){if(t.target.classList.contains(i.options.sliderItemClass)){if(i.draggedY)return t.preventDefault(),t.stopPropagation(),!1;if(!i.options.fullWidth){var e=i.getClosestItem(t.target),n=i.getItemIndex(e);0!=i.center%i.itemCount-n&&(t.preventDefault(),t.stopPropagation()),i.cycleTo(n)}}},this.tapHandler=function(t){(t.target===i.sliderContainer||t.target.classList.contains(i.options.sliderItemClass))&&t.preventDefault(),i.pressed=!0,i.draggedX=!1,i.draggedY=!1,i.velocity=0,i.amplitude=0,i.frame=i.offset,i.timestamp=Date.now(),i.referencePos={x:i.getXPos(t),y:i.getYPos(t)},clearInterval(i.ticker),i.ticker=setInterval(i.track,100)},this.dragHandler=function(t){if(i.pressed){var e=i.getXPos(t),n=i.getYPos(t),s=i.referencePos.x-e;if(30>_Mathabs(i.referencePos.y-n)&&!i.draggedX)(2<s||-2>s)&&(i.draggedY=!0,i.referencePos.x=e,i.scroll(i.offset+s));else{if(i.draggedY)return t.preventDefault(),t.stopPropagation(),!1;i.draggedX=!0}}return i.draggedY?(t.preventDefault(),t.stopPropagation(),!1):void 0},this.releaseHandler=function(t){if(i.pressed)return i.pressed=!1,clearInterval(i.ticker),i.target=i.offset,(10<i.velocity||-10>i.velocity)&&(i.amplitude=.9*i.velocity,i.target=i.offset+i.amplitude),i.target=_Mathround(i.target/i.dim)*i.dim,i.options.noWrap&&(i.target>=i.dim*(i.itemCount-1)?i.target=i.dim*(i.itemCount-1):0>i.target&&(i.target=0)),i.amplitude=i.target-i.offset,i.timestamp=Date.now(),requestAnimationFrame(i.autoScroll),i.draggedY&&(t.preventDefault(),t.stopPropagation()),!1},this.resizeHandler=function(){i.options.fullWidth?(i.setSliderDimensions(),i.offset=2*i.center*i.itemDimensions.width,i.target=i.offset):i.scroll()},this.track=function(){var t=Date.now(),e=t-i.timestamp;i.timestamp=t;var n=i.offset-i.frame;i.frame=i.offset,i.velocity=1e3*n/(1+e)*.8+.2*i.velocity},this.wrap=function(t){var e=i.itemCount;return t>=e?t%e:0>t?i.wrap(e+t%e):t},this.cycleTo=function(t){var e=i.itemCount,n=i.center%e-t;i.options.noWrap||(0>n&&_Mathabs(n+e)<_Mathabs(n)?n+=e:0<n&&_Mathabs(n-e)<n&&(n-=e)),0>n?i.nextHandler(_Mathabs(n)):0<n&&i.prevHandler(n)},this.scroll=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=void 0,n=0,s=void 0,o=void 0;i.setScrollTimeout(),i.lastCenter=i.center,i.offset="number"==typeof t?t:i.offset,i.center=Math.floor((i.offset+i.dim/2)/i.dim);var a=i.offset-i.center*i.dim,r=0>a?1:-1,l=-r*a*2/i.dim,d=i.itemCount>>1;for((!i.options.noWrap||0<=i.center&&i.center<i.itemCount)&&(e=i.items[i.wrap(i.center)],i.setActiveItem(e),i.renderTranslation(e,0,i.options.fullWidth?1:1-.2*l,-a/2,i.options.zoomScale*l,r*i.options.shift*l*n)),n=1;n<=d;++n)i.options.fullWidth?(o=i.options.zoomScale,s=n==d&&0>a?1-l:1):(o=i.options.zoomScale*(2*n+l*r),s=1-.2*(2*n+l*r)),(!i.options.noWrap||i.center+n<i.itemCount)&&(e=i.items[i.wrap(i.center+n)],i.renderTranslation(e,-n,s,i.options.shift+(i.dim*n-a)/2,o)),i.options.fullWidth?(o=i.options.zoomScale,s=n==d&&0<a?1-l:1):(o=i.options.zoomScale*(2*n-l*r),s=1-.2*(2*n-l*r)),(!i.options.noWrap||0<=i.center-n)&&(e=i.items[i.wrap(i.center-n)],i.renderTranslation(e,-n,s,-i.options.shift+(-i.dim*n-a)/2,o));i.lastCenter!==i.center&&"function"==typeof i.options.onCycleTo&&i.options.onCycleTo.call(i,i.activeItem,i.draggedY)},this.setScrollTimeout=function(){i.scrolling=!0,i.sliderContainer.classList.contains(i.options.scrollingClass)&&i.sliderContainer.classList.add(i.options.scrollingClass),null!=i.scrollingTimeout&&window.clearTimeout(i.scrollingTimeout),i.scrollingTimeout=window.setTimeout(function(){i.scrolling=!1,i.sliderContainer.classList.remove(i.options.scrollingClass)},i.options.transitionDuration)},this.setActiveItem=function(t){t.classList.contains(i.options.activeItemClass)||(null!==i.activeItem&&i.activeItem.classList.remove(i.options.activeItemClass),i.activeItem=t,i.activeItemIndex=i.getItemIndex(t),!i.activeItem.classList.contains(i.options.activeItemClass)&&i.activeItem.classList.add(i.options.activeItemClass)),i.setActiveIndicator()},this.setActiveIndicator=function(){i.options.indicators&&i.activeIndicator!==i.indicators[i.activeItemIndex]&&(i.activeIndicator.classList.remove(i.options.indicatorActiveClass),i.activeIndicator=i.indicators[i.activeItemIndex],i.activeIndicator.classList.add(i.options.indicatorActiveClass))},this.renderTranslation=function(t,e,n,s,o){var a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,r="translateX(0)";if(!i.options.fullWidth){r="translateX("+(i.sliderContainer.clientWidth-i.itemDimensions.width)/2+"px) translateY("+(i.sliderContainer.clientHeight-i.itemDimensions.height)/2+"px)"}var l="";null!==a&&(l="translateX("+a+"px) "),t.style[i.xForm]=r+" translateX("+s+"px) "+l+"translateZ("+o+"px)",t.style.zIndex=e,t.style.opacity=n,t.style.display="block"},this.autoScroll=function(){if(i.amplitude){var t=Date.now()-i.timestamp,e=i.amplitude*Math.exp(-t/i.options.transitionDuration);2<e||-2>e?(i.scroll(i.target-e),requestAnimationFrame(i.autoScroll)):i.scroll(i.target)}},this.next=function(){var t=i.activeItemIndex+1;(!i.options.noWrap||i.options.noWrap&&t<i.itemCount)&&i.cycleTo(t)},this.prev=function(){var t=i.activeItemIndex-1;(!i.options.noWrap||i.options.noWrap&&0<=t)&&i.cycleTo(t)},this.set=function(t){return i.cycleTo(t)},this.activeIndicator=null,this.activeItem=null,this.activeItemIndex=0,this.amplitude=null,this.center=0,this.sliderContainer=e,this.draggedX=!1,this.draggedY=!1,this.frame=null,this.lastCenter=null,this.offset=0,this.options=Object.assign({},t.defaults,n),this.pressed=!1,this.referencePos={x:0,y:0},this.scrolling=!1,this.scrollingTimeout=null,this.target=0,this.ticker=null,this.timestamp=null,this.velocity=null,this.init()}return _createClass(t,[{key:"init",value:function(){this.setSliderContainer(),this.setSliderItems(),this.setSliderDimensions(),this.setIndicators(),this.setXForm(),this.bindEvents(),this.sliderContainer.classList.contains(this.options.initializedClass)?(this.resizeHandler(),this.cycleTo(this.activeItemIndex)):this.sliderContainer.classList.add(this.options.initializedClass),this.scroll()}},{key:"setSliderContainer",value:function(){if("string"==typeof this.sliderContainer&&(this.sliderContainer=document.querySelector(this.sliderContainer)),!(this.sliderContainer instanceof HTMLElement))throw new Error("\n        The slider needs to be instantiated with an HTML Element as the first parameter or a valid CSS selector.\n        eg.: new Carousel(document.getElementById('MyElement')) or new Carousel('#myElement').\n      ");this.sliderContainer.classList.contains(this.options.sliderClass)||this.sliderContainer.classList.add(this.options.sliderClass)}},{key:"setSliderItems",value:function(){var t=this.sliderContainer.children;this.items=[];for(var e,i=0,n=t.length;i<n;i++)e=t[i],e.classList.contains(this.options.sliderItemClass)&&(this.items.push(e),e.classList.contains(this.options.activeItemClass)&&(this.activeItemIndex=i));if(this.itemCount=this.items.length,!this.itemCount)throw new Error("\n        The slider does not contain any valid items. \n        Please ensure that the items have the class name 'slider-item' appended to them.\n      ")}},{key:"setSliderDimensions",value:function(){var t=this.items[0];t.style.display="block",this.itemDimensions={height:t.offsetHeight,width:t.offsetWidth},this.sliderContainer.style.height=t.offsetHeight,this.dim=2*this.itemDimensions.width+this.options.padding,t.style.display="none"}},{key:"setIndicators",value:function(){var t=this;if(this.options.indicators){this.indicators=[],this.indicatorContainer=document.createElement(this.options.indicatorContainerTag),this.indicatorContainer.className=this.options.indicatorContainerClass,this.sliderContainer.appendChild(this.indicatorContainer);for(var e=0;e<this.itemCount;e++)!function(e){var i=document.createElement(t.options.indicatorItemTag);i.className=t.options.indicatorItemClass,i.innerHTML='<a href="#">'+t.options.indicatorText+"</a>",0===e&&(t.activeIndicator=i,i.classList.add(t.options.indicatorActiveClass)),i.addEventListener("click",function(i){i.preventDefault(),t.set(e)}),t.indicatorContainer.appendChild(i),t.indicators.push(i)}(e)}}},{key:"setXForm",value:function(){var t="transform";["webkit","Moz","O","ms"].forEach(function(e){var i=e+"Transform";void 0!==document.body.style[i]&&(t=i)}),this.xForm=t}},{key:"bindEvents",value:function(){void 0!==window.ontouchstart&&(this.sliderContainer.addEventListener("touchstart",this.tapHandler),this.sliderContainer.addEventListener("touchmove",this.dragHandler),this.sliderContainer.addEventListener("touchend",this.releaseHandler)),this.sliderContainer.addEventListener("mousedown",this.tapHandler),this.sliderContainer.addEventListener("mousemove",this.dragHandler),this.sliderContainer.addEventListener("mouseup",this.releaseHandler),this.sliderContainer.addEventListener("mouseleave",this.releaseHandler),this.sliderContainer.addEventListener("click",this.clickHandler),window.addEventListener("resize",this.resizeHandler)}}]),t}();return t.defaults={activeItemClass:"active",fullWidth:!1,scrollingClass:"scrolling",indicators:!1,indicatorActiveClass:"active",indicatorContainerTag:"ul",indicatorContainerClass:"indicators",indicatorItemTag:"li",indicatorItemClass:"indicator",indicatorText:"&bull;",initializedClass:"initialized",noWrap:!1,onCycleTo:null,padding:0,shift:0,sliderClass:"micro-slider",sliderItemClass:"slider-item",transitionDuration:250,zoomScale:-100},t});